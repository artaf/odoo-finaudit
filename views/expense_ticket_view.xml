<?xml version="1.0" encoding="utf-8"?>
<odoo>
<data>

    <record id="expense_ticket_form" model="ir.ui.view">
        <field name="name">expense.ticket.form</field>
        <field name="model">lfx.expense.ticket</field>
        <field name="priority">20</field>
        <field name="arch" type="xml">
            <form string="Expense ticket">
            <header>
<!--
                <button name="expense_ticket_print" string="Print" type="object" class="oe_highlight"
                     groups="lfx_expense_ticket.group_expense_ticket, account.group_account_user"/>
-->
<!-- User buttons, Draft -->
                <button name="expense_ticket_drafttocreate" states="draft" string="Validate" class="oe_highlight"
                     groups="lfx_expense_ticket.group_expense_ticket, account.group_account_user"/>
                <button name="expense_ticket_drafttocancel" string="Cancel" attrs="{'invisible': ['|',('name', '=', '/'),('state','!=','draft')]}"
                     groups="lfx_expense_ticket.group_expense_ticket"/>
<!-- User buttons, Create -->
                <button name="expense_ticket_createtodh" states="create" string="To Department Head" class="oe_highlight"
                     groups="lfx_expense_ticket.group_expense_ticket, account.group_account_user"/>
                <button name="expense_ticket_createtodraft" states="create" string="Draft"
                     groups="lfx_expense_ticket.group_expense_ticket, account.group_account_user"/>
                <button name="expense_ticket_createtocancel" states="create" string="Cancel"
                     groups="lfx_expense_ticket.group_expense_ticket"/>
<!-- Department Head -->
                <button name="expense_ticket_dhtocfo" states="departmenthead" string="To CFO" class="oe_highlight"
                     groups="base.group_user"/>
                <button name="expense_ticket_dhtodraft" states="departmenthead" string="Decline" class="oe_highlight"
                     groups="base.group_user"/>
<!-- CFO -->
                <button name="expense_ticket_cfotoopen" states="cfo" string="Validate" class="oe_highlight"
                     groups="base.group_user"/>
                <button name="expense_ticket_cfotodraft" states="cfo" string="Decline" class="oe_highlight"
                     groups="base.group_user"/>
<!-- Open -->
                <button name="expense_ticket_opentopaid" states="open" string="Paid"
                     groups="account.group_account_user"/>
                <button name="expense_ticket_opentocancel" states="open" string="Cancel"
                     groups="account.group_account_user"/>
<!-- Paid -->
                <button name="expense_ticket_paidtocancel" states="paid" string="Cancel"
                     groups="account.group_account_user"/>


                <field name="state" widget="statusbar" statusbar_visible="draft,create,departmenthead,cfo,open,paid" statusbar_colors='{"proforma":"blue"}'/>
            </header>
            <sheet string="Expense ticket">
                <div>
                    <label string="Draft Expense ticket" attrs="{'invisible': [('state','&lt;&gt;','draft')]}"/>
                    <label string="Expense ticket " attrs="{'invisible': [('state', '=', 'draft')]}"/>
                    <h1 class="mt0">
                        <field name="name" class="oe_inline"  attrs="{'invisible': [('name', '=', '/')]}"/>
                    </h1>
                </div>
                <group>
                    <group>
                        <field name="date_expenseticket"/>
                        <field string="Analytic Code" name="account_analytic_id" options="{'no_create': True}"/>
                        <field string="Objective of Payment" name="reference"/>
                    </group>
                    <group>
                        <field name="company_id" options="{'no_create': True}" groups="base.group_multi_company"/>
                        <field name="user_id" string="Responsible" readonly="1" context="{'default_groups_ref': ['base.group_user', 'base.group_partner_manager', 'account.group_account_invoice']}"/>
                        <field name="company_currency_id"  invisible="0"/>
                    </group>
                </group>
                <notebook>
                    <page string="Expenses">
<!--                        <field context="{'type': type, 'journal_id': journal_id}" name="expense_ticket_line_ids"> -->
                        <field name="expense_ticket_line_ids">
                            <tree string="Expense ticket lines" editable="bottom">
                                <field name="sequence" widget="handle" />
                                <field name="name"/>
                                <field name="partner_id" domain="[('supplier', '=', True)]"/>
                                <field name="partner_bank_id" domain="[('partner_id', '=', partner_id )]"/>
                                <field name="currency_id" options="{'no_create': True}" groups="base.group_multi_currency"/>
                                <field name="amount_currency"/>
                                <field name="company_currency_id" invisible="1"/>
                                <field name="amount_company_currency"/>
                                <field name="company_id" invisible="1"/>
                                <field name="date_line" invisible="1"/>
                                <field name="date_due"/>
                                <field name="account_id" groups="account.group_account_user"
                                    domain="[('company_id', '=', parent.company_id), ('internal_type', '=', 'other')]"/>
                            </tree>
                        </field>
                        <group>
                            <group class="oe_subtotal_footer oe_right">
                                <field name="amount_total_company_currency" class="oe_subtotal_footer_separator"/>

<!--                                <field name="payments_widget" colspan="2" nolabel="1" widget="payment"/>
                                <field name="residual" class="oe_subtotal_footer_separator" attrs="{'invisible': [('state', '=', 'draft')]}"/>
                                <field name="reconciled" invisible="1"/>
                                <field name="outstanding_credits_debits_widget" colspan="2" nolabel="1" widget="payment" attrs="{'invisible': [('state', 'not in', 'open')]}"/>
-->
                            </group>
                        </group>
                        <div>
                            <field name="comment" placeholder="Additional notes..."/>
                        </div>
                    </page>
                    <page string="Accounting" groups="account.group_account_invoice">
                        <group>
                            <group>
<!--                                <field name="journal_id" groups="account.group_account_user" options="{'no_create': True}"
                                    attrs="{'readonly':[('move_name','!=',False)]}"/>
-->
<!--                                <field domain="[('partner_id', '=', partner_id)]" name="partner_bank_id" invisible="1"/> -->

<!--
                                <field domain="[('company_id', '=', company_id), ('internal_type', '=', 'payable'), ('deprecated', '=', False)]"
                            name="account_id" groups="account.group_account_manager"/>
-->
                            </group>
                            <group>
                                <field name="date" domain="[('state', '=', 'draft'), ('company_id', '=', company_id)]" groups="account.group_account_user"/>
                            </group>
                        </group>
                    </page>
                </notebook>
            </sheet>
            <div class="oe_chatter">
                <field name="message_follower_ids" widget="mail_followers"/>
                <field name="message_ids" widget="mail_thread"/>
            </div>
            </form>
        </field>
    </record>


    <record id="expense_ticket_tree_view" model="ir.ui.view">
        <field name="name">lfx.expense.ticket.tree</field>
        <field name="model">lfx.expense.ticket</field>
        <field name="arch" type="xml">
            <tree decoration-info="state == 'draft'" decoration-muted="state == 'cancel'" string="expenseticket">
                <field name="date_expenseticket"/>
                <field name="name"/>
                <field name="state"/>
                <field name="account_analytic_id"/>
<!--                <field name="currency_id" invisible="1"/> -->
<!--                <field name="amount_currency_total"/> -->
                <field name="company_currency_id" invisible="1"/>
                <field name="amount_total_company_currency"/>
                <field name="user_id"/>
                <field name="company_id" groups="base.group_multi_company" options="{'no_create': True}"/>
            </tree>
        </field>
    </record>

<!--
    <field domain="[('company_id', '=', parent.company_id), ('account_type', '=', 'normal')]" name="account_analytic_id" groups="analytic.group_analytic_accounting"/>
-->

    <record id="expense_ticket_tree_action" model="ir.actions.act_window">
        <field name="name">Expense tickets</field>
        <field name="res_model">lfx.expense.ticket</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>
        <field name="view_id" eval="False"/>
        <field name="help" type="html">
          <p class="oe_view_nocontent_create">
            Click to record a new expense tcket.
          </p><p>
            You can control the expense ticket from your vendor according to what you purchased or received.
          </p>
        </field>
    </record>

<!--
    <record id="expense_ticket_line_tree_view" model="ir.ui.view">
        <field name="name">lfx.expense.ticket.line.tree</field>
        <field name="model">lfx.expense.ticket.line</field>
        <field name="arch" type="xml">
            <tree string="Expense Ticket Line">
                <field name="name"/>
                <field name="partner_id"/>
                <field name="partner_bank_id"/>
                <field name="account_id"/>
                <field name="currency_id" invisible="1"/>
                <field name="amount_currency"/>
-->
<!--                    <field name="amount_company_currency"/> -->
<!--                <field name="date_due"/>
            </tree>
        </field>
    </record>

    <record id="expense_ticket_line_form_view" model="ir.ui.view">
        <field name="name">lfx.expense.ticket.line.form</field>
        <field name="model">lfx.expense.ticket.line</field>
        <field name="arch" type="xml">
            <form string="Expense Ticket Line">
-->
<!--                <group> -->
<!--                    <field name="name"/>
                    <field name="partner_id" domain="[('supplier', '=', True)]"/>
                    <field name="partner_bank_id"/>
                    <field name="currency_id" groups="base.group_multi_currency"/>
                    <field name="amount_currency"/>
-->
<!--                        <field name="amount_company_currency" readonly="1"/> -->
<!--                    <field name="account_id"/>--> <!--  domain="[('company_id', '=', parent.company_id)]" -->
<!--                        <field name="company_id" groups="base.group_multi_company" readonly="1"/> -->
<!--                </group> -->
<!--
            </form>
        </field>
    </record>
-->
<!--
    <record id="expense_ticket_line_tree_action" model="ir.actions.act_window">
        <field name="name">Expense ticket line</field>
        <field name="res_model">lfx.expense.ticket.line</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>
        <field name="view_id" eval="False"/>
    </record>

    <menuitem id="expense_ticket_line_tree_menu" action="expense_ticket_line_tree_action" parent="account.menu_finance_payables" sequence="3"/>
-->
    <menuitem id="expense_ticket_tree_menu" action="expense_ticket_tree_action" parent="account.menu_finance_payables"
        groups="lfx_expense_ticket.group_expense_ticket" sequence="2"/>
              
</data>
</odoo>
