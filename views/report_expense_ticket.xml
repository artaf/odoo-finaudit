<?xml version="1.0" encoding="utf-8"?>
<odoo>
<data>

<template id="report_expense_ticket_document">
    <t t-call="report.internal_layout">
        <div class="page">
            <h2>
                <span t-if="o.state == 'draft'">Draft Expense ticket</span>
                <span t-if="o.state == 'cancel'">Cancelled Expense ticket</span>
                <span t-if="o.state != 'draft' and o.state != 'cancel'">Expense ticket</span>
                <span t-field="o.name"/>
            </h2>
            <div class="col-xs-12 mt32 mb32" t-if="o.date_expenseticket">
                <strong>Expense ticket Date:</strong>
                <span t-field="o.date_expenseticket"/>
            </div>
            <div class="col-xs-12 mb32" t-if="o.date_expenseticket">
                <strong>Code:</strong>
                <span t-field="o.account_analytic_id"/>
            </div>
            <div calss="col-xs-12 mb32">
                <strong>Objective of Payment:</strong>
                <span t-if="o.reference" t-field="o.reference"/>
            </div>

            <table class="table table-condensed">
                <thead>
                    <tr>
                        <th>Payment details </th>
                        <th>Supplier</th>
                        <th>Bank account</th>
                        <th class="text-right">Due date</th>
                        <th class="text-right">Amount</th>
                        <th class="text-right">In company currency</th>
                    </tr>
                </thead>
                <tbody class="invoice_tbody">
                    <tr t-foreach="o.expense_ticket_line_ids" t-as="l">
                        <td><span t-field="l.name"/></td>
                        <td><span t-field="l.partner_id.name"/></td>
                        <td><t t-if="l.partner_bank_id">
                            <span t-field="l.partner_bank_id.bank_id.name"/>:
                            <span t-field="l.partner_bank_id.acc_number"/>
                        </t></td>
                        <td class="text-right"><span t-field="l.date_due"/></td>
                        <td class="text-right">
                            <span t-field="l.amount_currency"
                                t-field-options='{"widget": "monetary", "display_currency": "o.currency_id"}'/>
                        </td>
                        <td class="text-right">
                            <span t-field="l.amount_company_currency"
                                t-field-options='{"widget": "monetary", "display_currency": "o.company_currency_id"}'/>
                        </td>
                    </tr>
                </tbody>
        </table>

        <div class="row">
            <div class="col-xs-4 pull-right">
                <table class="table table-condensed">
                    <tr class="border-black">
                        <td><strong>Total</strong></td>
                        <td class="text-right">
                            <span t-field="o.amount_total_company_currency"
                                t-field-options='{"widget": "monetary", "display_currency": "o.company_currency_id"}'/>
                        </td>
                    </tr>
                </table>
            </div>
       </div>

        <p t-if="o.comment">
            <strong>Comment:</strong>
            <span t-field="o.comment"/>
        </p>

        <div class="row mt32">
            <strong>Responsible:</strong>
            <span t-field="o.user_id.name"/>
        </div>

        <div class="row mt32">
            <strong>Approval of Department Head:</strong>
            <span t-if="o.state=='cancel'">Cancelled</span>
        </div>

        <div class="row mt32">
            <strong>Approval of Finance Director:</strong>
            <span t-if="o.state=='cancel'">Cancelled</span>
        </div>

        <div class="row mt32">
            <hr/>
            <strong>For Use of Finance Department Only</strong>
            <div class="row mt32">
                1)  Mode of payment :
            </div>
            <div class="row mt32">
                2)  Transaction ID :
            </div>
            <div class="row mt32">
                3)  Date of payment :
            </div>
            <div class="row mt32">
                4)  Row Number of the entry :
            </div>
            <div class="row mt32">
                5)  Company :
            </div>
            <div class="row mt32 text-right">
                Signature of Accounts Payable officer
            </div>
        </div>
    </div>
    </t>
</template>

<template id="report_expense_ticket">
    <t t-call="report.html_container">
        <t t-foreach="docs" t-as="o">
            <t t-call="lfx_expense_ticket.report_expense_ticket_document"/>
        </t>
    </t>
</template>

        <!-- QWeb Reports -->
        <report 
            id="report_expense_tickets_pdf"
            model="lfx.expense.ticket"
            string="Expense tickets (pdf)"
            report_type="qweb-pdf"
            name="lfx_expense_ticket.report_expense_ticket"
            file="lfx_expense_ticket.report_expense_ticket"
            attachment_use="False"
        />

        <report 
            id="report_expense_tickets_html"
            model="lfx.expense.ticket"
            string="Expense tickets (html)"
            report_type="qweb-html"
            name="lfx_expense_ticket.report_expense_ticket"
        />

</data>
</odoo>
